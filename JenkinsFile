pipeline {
    agent { label 'master'}
    options{
        timestamps()
           }
     environment {
    PATH = "C:\\Program Files\\Git\\usr\\bin;C:\\Program Files\\Git\\bin;${env.PATH}"
    }
    stages {
        stage('Git Checkout') {
            steps {
                echo 'Hello World'
            }
        }

        stage('Build'){
            options {
                timeout(time: 1, unit: "HOURS")
            }
            steps {
                echo "Building"
                withCredentials([sshUserPrivateKey(credentialsId: 'Test123', keyFileVariable: 'Key')]) {
                    sh '''
            ' > deploy
            chmod +x deploy
                   scp -o 'StrictHostKeyChecking no' -r deploy ubuntu@52.60.236.156:/tmp
            ssh -o 'StrictHostKeyChecking no' -t ubuntu@52.60.236.156 /tmp/deploy
            ssh -o 'StrictHostKeyChecking no' -t ubuntu@52.60.236.156 rm -rf /tmp/deploy
                    '''
                    }
                //sleep 5
            }
        }

        stage('Test'){
            steps{
                echo "Testing123"   
            }
    }
}
 post { 
        always { 
            cleanWs()
        }
    }
}
